---
title: "006 - Smallest Subsequence（★5）"
---

[006 \- Smallest Subsequence（★5）](https://atcoder.jp/contests/typical90/tasks/typical90_f)

# アルゴリズム

## 二分探索 (BTreeSet::range())

`atcoder` の長さ3の部分文字列で最小なものを求めます。まず文字ごとの出現順に並び替えます。

||0|1|2|3|4|5|6|
|---|---|---|---|---|---|---|---|
|a|0|||||||
|c|||2|||||
|d|||||4|||
|e||||||5||
|o||||3||||
|r|||||||6|
|t||1||||||

最小の文字列の最初の 1文字目は、7文字のうち後ろ 2文字を除いた範囲 `[0, 5)` の中で、辞書順に最初に見つかる文字です。もし 4文字目を使っても、そのあと 5, 6 番目を採用すれば良いです。

||🔍0|🔍1|🔍2|🔍3|🔍4|5|6|
|---|---|---|---|---|---|---|---|
|a|✅0|||||||
|c|||2|||||
|d|||||4|||
|e||||||5||
|o||||3||||
|r|||||||6|
|t||1||||||

2文字目は、`[1, 6)` の範囲で最初に見つかる文字です。`a` はこの範囲内になく、次の `c` が範囲内にあります。

||0|🔍1|🔍2|🔍3|🔍4|🔍5|6|
|---|---|---|---|---|---|---|---|
|a|✅0|||||||
|c|||✅2|||||
|d|||||4|||
|e||||||5||
|o||||3||||
|r|||||||6|
|t||1||||||

3文字目は、`[3, 7)` の範囲で最初に見つかる文字です。`a`, `c` はこの範囲内になく、次の `d` が範囲内にあります。

||0|1|2|🔍3|🔍4|🔍5|🔍6|
|---|---|---|---|---|---|---|---|
|a|✅0|||||||
|c|||✅2|||||
|d|||||✅4|||
|e||||||5||
|o||||3||||
|r|||||||6|
|t||1||||||

このように `[l, r)` 範囲内の最初の値を得たいときには `BTreeSet::range()` が便利です。二分探索したいので `HashSet` は使えません。

[BTreeSet in std::collections \- Rust > range()](https://doc.rust-lang.org/std/collections/struct.BTreeSet.html#method.range)

```rust
if let Some(i) = set.range(l..r).next() {
    // ...
}
```

26個の set に、a から順に範囲内に問い合わせる感じです。


## 次の候補をメモ

||候補|0|1|2|3|4|5|6|
|---|---|---|---|---|---|---|---|---|
|a|0|0|||||||
|c|2|||2|||||
|d|4|||||4|||
|e|5||||||5||
|o|3||||3||||
|r|6|||||||6|
|t|1||1||||||

||候補|🔍0|🔍1|🔍2|🔍3|🔍4|5|6|
|---|---|---|---|---|---|---|---|---|
|a|0|✅0|||||||
|c|2|||2|||||
|d|4|||||4|||
|e|5||||||5||
|o|3||||3||||
|r|6|||||||6|
|t|1||1||||||

||候補|0|🔍1|🔍2|🔍3|🔍4|🔍5|6|
|---|---|---|---|---|---|---|---|---|
|a|-|✅0|||||||
|c|2|||✅2|||||
|d|4|||||4|||
|e|5||||||5||
|o|3||||3||||
|r|6|||||||6|
|t|1||1||||||

1つ採用するたびに次の候補を更新する、という方法もあります。同じ場所を繰り返し調べないため、より高速です。


# Tips

## let else

* [let\-else \- Rust By Example 日本語版](https://doc.rust-jp.rs/rust-by-example-ja/flow_control/let_else.html)

Rust 1.65 で増えた構文です。

```rust
if let Some(i) = set.range(l..r).next() {
    // ...
}
```

のように書くとインデントが 1つ増えますが、

```rust
let Some(i) = set.range(l..r).next() else {
    continue;
}
// ...
```

のように書くとインデントが増えません。インデントが深くなるとかっこの対応関係を辿りづらくなりますので、おすすめです。

let else` 構文が rustfmt フォーマッターの対象になったのは Rust 1.72 です。AtCoder 2023年版の Rust 1.70 ではまだ使えません。次回更新に期待です。


# 実装例

## 二分探索
https://github.com/hossy3/atcoder-solutions/blob/main/atcoder/typical90/src/bin/006_range.rs

## 次の候補をメモ
https://github.com/hossy3/atcoder-solutions/blob/main/atcoder/typical90/src/bin/006_greedy.rs
