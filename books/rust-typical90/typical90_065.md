---
title: "065 - RGB Balls 2ï¼ˆâ˜…7ï¼‰"
---

[065 \- RGB Balls 2ï¼ˆâ˜…7ï¼‰](https://atcoder.jp/contests/typical90/tasks/typical90_bm)


# ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

## å•é¡Œ - å…¥åŠ›ä¾‹1

å•é¡Œã®å…¥åŠ›ä¾‹1ã«ã¤ã„ã¦ã€ã¾ãšè€ƒãˆã¾ã™ã€‚

* èµ¤ãƒ»ç·‘ãƒ»é’ã®ãƒœãƒ¼ãƒ«ãŒãã‚Œãã‚Œ (R, G, B) = (3, 1, 2) å€‹ã‚ã‚‹
* ãƒœãƒ¼ãƒ«ã‚’å…¨éƒ¨ã§ K = 5 å€‹é¸ã¶
* èµ¤ãƒ»ç·‘ã®ãƒœãƒ¼ãƒ«ã®åˆè¨ˆã¯ X = 4 ä»¥ä¸‹
* ç·‘ãƒ»é’ã®ãƒœãƒ¼ãƒ«ã®åˆè¨ˆã¯ Y = 2 ä»¥ä¸‹
* é’ãƒ»èµ¤ã®ãƒœãƒ¼ãƒ«ã®åˆè¨ˆã¯ Z = 4 ä»¥ä¸‹

## 2è‰²ã®çµ„ã¿åˆã‚ã›æ¡ä»¶ã‚’1è‰²ã«æ¸›ã‚‰ã™ - å…¥åŠ›ä¾‹1

> èµ¤ãƒ»é’ã®ãƒœãƒ¼ãƒ«ã®åˆè¨ˆã¯ X = 4 ä»¥ä¸‹

èµ¤ã¨é’ã®åˆè¨ˆãŒ 4 ä»¥ä¸‹ã¨ã„ã†æ¡ä»¶ã§ã¯ã€èµ¤ã®å€‹æ•°ã«å¿œã˜ã¦é’ã®å€‹æ•°ãŒæ±ºã¾ã‚Šã¾ã™ã€‚ã—ã‹ã—ã€ã“ã‚Œã§ã¯ 2è‰²ã®çµ„ã¿åˆã‚ã›ã‚’å€‹åˆ¥ã«è€ƒãˆã‚‹å¿…è¦ãŒã‚ã‚Šã€è¤‡é›‘ã«ãªã‚Šã¾ã™ã€‚

æ¡ä»¶ã‚’å˜ç´”åŒ–ã™ã‚‹ãŸã‚ã€ã€Œèµ¤ãƒ»é’ã®ãƒœãƒ¼ãƒ«ã®åˆè¨ˆã€ã‚’ã€Œç·‘ã®ãƒœãƒ¼ãƒ«ã®æ•°ã€ã«ç½®ãæ›ãˆã¾ã™ã€‚

ãƒœãƒ¼ãƒ«ã‚’å…¨éƒ¨ã§ K = 5 å€‹é¸ã³ã¾ã™ã€‚ã“ã“ã§ã€èµ¤ã¨é’ã§åˆè¨ˆ 4 å€‹ä»¥ä¸‹ ã¨ã„ã†æ¡ä»¶ã¯ã€è¨€ã„æ›ãˆã‚‹ã¨ã€Œç·‘ã®ãƒœãƒ¼ãƒ«ã‚’ 1 å€‹ä»¥ä¸Šä½¿ã†ã€ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

* èµ¤ãƒ»ç·‘ã®ãƒœãƒ¼ãƒ«ã®åˆè¨ˆã¯ X = 4 å€‹ä»¥ä¸‹
* ç·‘ãƒ»é’ã®ãƒœãƒ¼ãƒ«ã®åˆè¨ˆã¯ Y = 2 å€‹ä»¥ä¸‹
* é’ãƒ»èµ¤ã®ãƒœãƒ¼ãƒ«ã®åˆè¨ˆã¯ Z = 4 å€‹ä»¥ä¸‹

ã“ã‚Œã‚‰ã®æ¡ä»¶ã‚’ã€Œæœ€ä½é™å¿…è¦ãªå„è‰²ã®ãƒœãƒ¼ãƒ«ã®å€‹æ•°ã€ã¨ã—ã¦è¡¨ç¾ã—ç›´ã™ã¨ã€æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

* é’ã®ãƒœãƒ¼ãƒ«ã¯ X' = 1 å€‹ä»¥ä¸Š
* èµ¤ã®ãƒœãƒ¼ãƒ«ã¯ Y' = 3 å€‹ä»¥ä¸Š
* ç·‘ã®ãƒœãƒ¼ãƒ«ã¯ Z' = 1 å€‹ä»¥ä¸Š

ã€Œèµ¤ãƒ»ç·‘ãƒ»é’ã®ãƒœãƒ¼ãƒ«ãŒãã‚Œãã‚Œ (R, G, B) = (3, 1, 2) å€‹ã‚ã‚‹ã€ã§ã—ãŸã€‚çµ„ã¿åˆã‚ã›ã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

* èµ¤ã®ãƒœãƒ¼ãƒ«ã¯ Y' = 3 å€‹ä»¥ä¸Šã€ã‹ã¤ R = 3 å€‹ä»¥ä¸‹
* ç·‘ã®ãƒœãƒ¼ãƒ«ã¯ Z' = 1 å€‹ä»¥ä¸Šã€ã‹ã¤ G = 1 å€‹ä»¥ä¸‹
* é’ã®ãƒœãƒ¼ãƒ«ã¯ X' = 1 å€‹ä»¥ä¸Šã€ã‹ã¤ B = 2 å€‹ä»¥ä¸‹

ãã‚Œãã‚Œã®ãƒœãƒ¼ãƒ«ã®å€‹æ•°ã¯ã“ã®ç¯„å›²å†…ã«åã¾ã‚Šã€åˆè¨ˆãŒ 5 å€‹ã«ãªã‚‹ã‚ˆã†ã«é¸ã³ã¾ã™ã€‚


||0|1|2|3|
|---|---|---|---|---|
|èµ¤|-|-|-|ğŸ”´|
|ç·‘|-|ğŸŸ¢|-|-|
|é’|-|ğŸ”µ|ğŸ”µ|-|


## çµ„ã¿åˆã‚ã›ã‚’è€ƒãˆã‚‹ - å…¥åŠ›ä¾‹1

> * èµ¤ã®ãƒœãƒ¼ãƒ«ã¯ Y' = 3 å€‹ä»¥ä¸Šã€R = 3 å€‹ä»¥ä¸‹
> * ç·‘ã®ãƒœãƒ¼ãƒ«ã¯ Z' = 1 å€‹ä»¥ä¸Šã€G = 1 å€‹ä»¥ä¸‹

ã—ãŸãŒã£ã¦ã€èµ¤ã¨ç·‘ã®ãƒœãƒ¼ãƒ«ã¯ã™ã¹ã¦é¸ã¶ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

> * é’ã®ãƒœãƒ¼ãƒ«ã¯ X' = 1 å€‹ä»¥ä¸Šã€B = 2 å€‹ä»¥ä¸‹

é’ã®ãƒœãƒ¼ãƒ«ã¯æœ€å¤§ 2 å€‹ã¾ã§é¸ã¹ã¾ã™ãŒã€ã™ã§ã«èµ¤ã¨ç·‘ã§ åˆè¨ˆ 4 å€‹ ã‚’é¸ã‚“ã§ã„ã‚‹ãŸã‚ã€æ®‹ã‚Š 1 å€‹ã—ã‹é¸ã¹ã¾ã›ã‚“ã€‚

ã—ãŸãŒã£ã¦ã€2 å€‹ã‚ã‚‹é’ã®ãƒœãƒ¼ãƒ«ã‹ã‚‰ 1 å€‹ã‚’é¸ã¶çµ„ã¿åˆã‚ã›ã¯ã€æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

$$_2C_1 = 2$$

|èµ¤ã®å€‹æ•°|ç·‘ã®å€‹æ•°|é’ã®å€‹æ•°|èµ¤ã®çµ„ã¿åˆã‚ã›|ç·‘ã®çµ„ã¿åˆã‚ã›|é’ã®çµ„ã¿åˆã‚ã›|åˆè¨ˆ|
|---|---|---|---|---|---|---|
|3|1|âœ…1|$_3C_3 = 1$|$_1C_1 = 1$|$_2C_1 = 2$|$1*1*2=2$|

ã¤ã¾ã‚Šã€2 é€šã‚Šã®é¸ã³æ–¹ãŒã‚ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚


## å•é¡Œ - å…¥åŠ›ä¾‹2

å…ˆã»ã©ã‚ˆã‚Šé›£ã—ã„å•é¡Œã‚’è€ƒãˆã¾ã™ã€‚ã“ã®å•é¡Œã¯ã€å…¬å¼è§£èª¬ã‚¹ãƒ©ã‚¤ãƒ‰ã§æ‰±ã‚ã‚ŒãŸã‚‚ã®ã¨åŒã˜å†…å®¹ã§ã™ã€‚

* èµ¤ãƒ»ç·‘ãƒ»é’ã®ãƒœãƒ¼ãƒ«ãŒãã‚Œãã‚Œ (R, G, B) = (5, 5, 6) å€‹ã‚ã‚‹
* ãƒœãƒ¼ãƒ«ã‚’å…¨éƒ¨ã§ K = 10 å€‹é¸ã¶
* èµ¤ãƒ»ç·‘ã®ãƒœãƒ¼ãƒ«ã®åˆè¨ˆã¯ X = 7 ä»¥ä¸‹
* ç·‘ãƒ»é’ã®ãƒœãƒ¼ãƒ«ã®åˆè¨ˆã¯ Y = 8 ä»¥ä¸‹
* é’ãƒ»èµ¤ã®ãƒœãƒ¼ãƒ«ã®åˆè¨ˆã¯ Z = 9 ä»¥ä¸‹

## 2è‰²ã®çµ„ã¿åˆã‚ã›æ¡ä»¶ã‚’1è‰²ã«æ¸›ã‚‰ã™ - å…¥åŠ›ä¾‹2

å…¥åŠ›ä¾‹1ã¨åŒæ§˜ã«ã€2è‰²ã®åˆè¨ˆã§è¡¨ã•ã‚Œã¦ã„ã‚‹æ¡ä»¶ã‚’1è‰²ã«ç½®ãæ›ãˆã¾ã™ã€‚ã“ã“ã§ã¯ã€ã€Œèµ¤ãƒ»é’ã®ãƒœãƒ¼ãƒ«ã®åˆè¨ˆã€ã‚’ã€Œç·‘ã®ãƒœãƒ¼ãƒ«ã®æ•°ã€ã«å¤‰æ›ã—ã¾ã™ã€‚ã™ã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

* é’ã®ãƒœãƒ¼ãƒ«ã¯ X' = 3 å€‹ä»¥ä¸Š
* èµ¤ã®ãƒœãƒ¼ãƒ«ã¯ Y' = 2 å€‹ä»¥ä¸Š
* ç·‘ã®ãƒœãƒ¼ãƒ«ã¯ Z' = 1 å€‹ä»¥ä¸Š

ãƒœãƒ¼ãƒ«ã®æ•° (5, 5, 6) ã¨çµ„ã¿åˆã‚ã›ã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

* èµ¤ã®ãƒœãƒ¼ãƒ«ã¯ Y' = 2 å€‹ä»¥ä¸Šã€R = 5 å€‹ä»¥ä¸‹
* ç·‘ã®ãƒœãƒ¼ãƒ«ã¯ Z' = 1 å€‹ä»¥ä¸Šã€G = 5 å€‹ä»¥ä¸‹
* é’ã®ãƒœãƒ¼ãƒ«ã¯ X' = 3 å€‹ä»¥ä¸Šã€B = 6 å€‹ä»¥ä¸‹

||0|1|2|3|4|5|6|
|---|---|---|---|---|---|---|---|
|èµ¤|-|-|ğŸ”´|ğŸ”´|ğŸ”´|ğŸ”´|-|
|ç·‘|-|ğŸŸ¢|ğŸŸ¢|ğŸŸ¢|ğŸŸ¢|ğŸŸ¢|-|
|é’|-|-|-|ğŸ”µ|ğŸ”µ|ğŸ”µ|ğŸ”µ|

## çµ„ã¿åˆã‚ã›ã‚’è€ƒãˆã‚‹ - å…¥åŠ›ä¾‹2

å…¥åŠ›ä¾‹1 ã¨åŒã˜ã‚ˆã†ã«è¨ˆç®—ã—ã¾ã™ã€‚

|èµ¤ã®å€‹æ•°|ç·‘ã®å€‹æ•°|é’ã®å€‹æ•°|èµ¤ã®çµ„ã¿åˆã‚ã›|ç·‘ã®çµ„ã¿åˆã‚ã›|é’ã®çµ„ã¿åˆã‚ã›|åˆè¨ˆ|
|---|---|---|---|---|---|---|
|2|1|âŒ7|${}_5C_2 = 10$|${}_5C_1 = 5$|$0$|$0$|
|2|2|âœ…6|${}_5C_2 = 10$|${}_5C_2 = 10$|${}_6C_6 = 1$|$10*10*1=100$|
|2|3|âœ…5|${}_5C_2 = 10$|${}_5C_3 = 10$|${}_6C_5 = 6$|$10*10*6=600$|
|2|4|âœ…4|${}_5C_2 = 10$|${}_5C_4 = 5$|${}_6C_4 = 15$|$10*5*15=750$|
|2|5|âœ…3|${}_5C_2 = 10$|${}_5C_5 = 1$|${}_6C_3 = 20$|$10*5*15=200$|
|3|1|âœ…6|${}_5C_3 = 10$|${}_5C_1 = 5$|${}_6C_6 = 1$|$10*5*1=50$|
|3|2|âœ…5|${}_5C_3 = 10$|${}_5C_2 = 10$|${}_6C_5 = 6$|$10*10*6=600$|
|3|3|âœ…4|${}_5C_3 = 10$|${}_5C_3 = 10$|${}_6C_4 = 15$|$10*10*15=1500$|
|3|4|âœ…3|${}_5C_3 = 10$|${}_5C_4 = 5$|${}_6C_3 = 20$|$10*5*20=1000$|
|3|5|âŒ2|${}_5C_3 = 10$|${}_5C_5 = 1$|$0$|$0$|
|4|1|âœ…5|${}_5C_4 = 5$|${}_5C_1 = 5$|${}_6C_5 = 6$|$5*5*6=150$|
|4|2|âœ…4|${}_5C_4 = 5$|${}_5C_2 = 10$|${}_6C_4 = 15$|$5*10*15=750$|
|4|3|âœ…3|${}_5C_4 = 5$|${}_5C_3 = 10$|${}_6C_3 = 20$|$5*10*20=1000$|
|4|4|âŒ2|${}_5C_4 = 5$|${}_5C_4 = 5$|$0$|$0$|
|4|5|âŒ1|${}_5C_4 = 5$|${}_5C_5 = 1$|$0$|$0$|
|5|1|âœ…4|${}_5C_5 = 1$|${}_5C_1 = 5$|${}_6C_4 = 15$|$1*5*15=75$|
|5|2|âœ…3|${}_5C_5 = 1$|${}_5C_2 = 10$|${}_6C_3 = 20$|$1*10*20=200$|
|5|3|âŒ2|${}_5C_5 = 1$|${}_5C_3 = 10$|$0$|$0$|
|5|4|âŒ1|${}_5C_5 = 1$|${}_5C_4 = 5$|$0$|$0$|
|5|5|âŒ0|${}_5C_5 = 1$|${}_5C_5 = 1$|$0$|$0$|

$$
100+600+750+200+50+600+1500+1000+150+750+1000+75+200=6975
$$

åˆè¨ˆã™ã‚‹ã¨ 6975 ã«ãªã‚Šã¾ã™ã€‚ã“ã‚ŒãŒç­”ãˆã§ã™ã€‚

å…¥åŠ›ä¾‹2ãã‚‰ã„ãªã‚‰ã“ã®ã‚ˆã†ã«è¨ˆç®—ã§ãã¾ã™ã€‚ã—ã‹ã—ã€çµ„ã¿åˆã‚ã›æ•°ãŒå¢—ãˆã‚‹ã¨åˆ¶é™æ™‚é–“å†…ã«é–“ã«åˆã‚ãªããªã‚Šã¾ã™ã€‚


## ç•³ã¿è¾¼ã¿ã§é«˜é€ŸåŒ–ã™ã‚‹

å‰ã®è¡¨ã§ã¯ã€${}_6C_6 = 1$ ãªã©ã®åŒã˜å¼ãŒç¹°ã‚Šè¿”ã—ç¾ã‚Œã¦ã„ã¾ã—ãŸã€‚è¨ˆç®—ã®é †åºã‚’å·¥å¤«ã™ã‚Œã°ã€ã‚ˆã‚Šé«˜é€ŸåŒ–ã§ããã†ã§ã™ã€‚

èµ¤ãƒ»ç·‘ãƒ»é’ã®3ã¤ã®å€‹æ•°ã«å¯¾å¿œã™ã‚‹è¡¨ã§ã™:

||ç·‘1|ç·‘2|ç·‘3|ç·‘4|ç·‘5|
|---|---|---|---|---|---|
|èµ¤2|âŒ3ï¸âƒ£é’7|âœ…4ï¸âƒ£é’6|âœ…5ï¸âƒ£é’5|âœ…6ï¸âƒ£é’4|âœ…7ï¸âƒ£é’3|
|èµ¤3|âœ…4ï¸âƒ£é’6|âœ…5ï¸âƒ£é’5|âœ…6ï¸âƒ£é’4|âœ…7ï¸âƒ£é’3|âŒ8ï¸âƒ£é’2|
|èµ¤4|âœ…5ï¸âƒ£é’5|âœ…6ï¸âƒ£é’4|âœ…7ï¸âƒ£é’3|âŒ8ï¸âƒ£é’2|âŒ9ï¸âƒ£é’1|
|èµ¤5|âœ…6ï¸âƒ£é’4|âœ…7ï¸âƒ£é’3|âŒ8ï¸âƒ£é’2|âŒ9ï¸âƒ£é’1|âŒğŸ”Ÿé’0|

æ¬¡ã«ã€èµ¤ãƒ»ç·‘ãƒ»é’ã®3ã¤ã®çµ„ã¿åˆã‚ã›æ•°ã«å¯¾å¿œã™ã‚‹è¡¨ã§ã™:

||ç·‘${}_5C_1$|ç·‘${}_5C_2$|ç·‘${}_5C_3$|ç·‘${}_5C_4$|ç·‘${}_5C_5$|
|---|---|---|---|---|---|
|èµ¤${}_5C_2$|3ï¸âƒ£âŒ|4ï¸âƒ£é’${}_6C_6$|5ï¸âƒ£é’${}_6C_5$|6ï¸âƒ£é’${}_6C_4$|7ï¸âƒ£é’${}_6C_3$|
|èµ¤${}_5C_3$|4ï¸âƒ£é’${}_6C_6$|5ï¸âƒ£é’${}_6C_5$|6ï¸âƒ£é’${}_6C_4$|7ï¸âƒ£é’${}_6C_3$|8ï¸âƒ£âŒ|
|èµ¤${}_5C_4$|5ï¸âƒ£é’${}_6C_5$|6ï¸âƒ£é’${}_6C_4$|7ï¸âƒ£é’${}_6C_3$|8ï¸âƒ£âŒ|9ï¸âƒ£âŒ|
|èµ¤${}_5C_5$|6ï¸âƒ£é’${}_6C_4$|7ï¸âƒ£é’${}_6C_3$|8ï¸âƒ£âŒ|9ï¸âƒ£âŒ|ğŸ”ŸâŒ|

(èµ¤, ç·‘, é’) = (3, 1, 4) å€‹ã®æ™‚ã®çµ„ã¿åˆã‚ã›ã¯ã€ èµ¤${}_5C_3$ * ç·‘${}_5C_1$ * ï¸4ï¸âƒ£é’${}_6C_6$ = ${}_5C_3 * {}_5C_1 * {}_6C_6$ ã§ã™ã€‚

æ–œã‚å³ä¸Šæ–¹å‘ã«åŒã˜æ•°å­— 4ï¸âƒ£ ãŒä¸¦ã‚“ã§ã„ã¾ã™ã€‚ã“ã‚Œã¯èµ¤ã¨ç·‘ã®åˆè¨ˆæ•°ã‚’è¡¨ã—ã¦ã„ã¾ã™ã€‚

å…ˆã« 4ï¸âƒ£ ãŒå…¥ã£ã¦ã„ã‚‹2ã¤ã®ãƒã‚¹ã®åˆè¨ˆã‚’æ±‚ã‚ã‚‹ã¨ã€å¾Œã‹ã‚‰ ${}_6C_6$ ã‚’1å›æ›ã‘ç®—ã™ã‚‹ã“ã¨ã§ã€å…¨ä½“ã®åˆè¨ˆå€¤ã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ä»–ã®æ ä»˜ãã®æ•°å­—ã«ã¤ã„ã¦ã‚‚ã€åŒã˜æ ä»˜ãã®æ•°å­—ã‚’åŒã˜è¡Œã«ä¸¦ã¹ã‚‹ã‚ˆã†ã«ã€è¡¨ã‚’æ•´ç†ã—ã¾ã™:

|èµ¤+ç·‘ã®å€‹æ•°|é’ã®å€‹æ•°|èµ¤+ç·‘ã®çµ„ã¿åˆã‚ã›|é’ã®çµ„ã¿åˆã‚ã›|çµ„ã¿åˆã‚ã›|
|---|---|---|---|---|
|3ï¸âƒ£|âŒ7|${}_5C_2 \cdot {}_5C_1$|$0$|$0$|
|4ï¸âƒ£|âœ…6|${}_5C_2 \cdot {}_5C_2 + {}_5C_3 \cdot {}_5C_1$|${}_6C_6$|$150 \times 1$|
|5ï¸âƒ£|âœ…5|${}_5C_2 \cdot {}_5C_3 + {}_5C_3 \cdot {}_5C_2 + {}_5C_4 \cdot {}_5C_1$|${}_6C_5$|$225 \times 6$|
|6ï¸âƒ£|âœ…4|${}_5C_2 \cdot {}_5C_4 + {}_5C_3 \cdot {}_5C_3 + {}_5C_4 \cdot {}_5C_2 + {}_5C_5 \cdot {}_5C_1$|${}_6C_4$|$205 \times 15$|
|7ï¸âƒ£|âœ…3|${}_5C_2 \cdot {}_5C_5 + {}_5C_3 \cdot {}_5C_4 + {}_5C_4 \cdot {}_5C_3 + {}_5C_5 \cdot {}_5C_2$|${}_6C_3$|$120 \times 20$|
|8ï¸âƒ£|âŒ2|${}_5C_3 \cdot {}_5C_5 + {}_5C_4 \cdot {}_5C_4 + {}_5C_5 \cdot {}_5C_3$|$0$|$0$|
|9ï¸âƒ£|âŒ1|${}_5C_4 \cdot {}_5C_5 + {}_5C_5 \cdot {}_5C_4$|$0$|$0$|
|ğŸ”Ÿ|âŒ0|${}_5C_5 \cdot {}_5C_5$|$0$|$0$|

$150 \times 1 + 225 \times 6 + 205 \times 15 + 120 \times 20 = 6975$ ã§ã™ã€‚å…ˆã»ã©ã‚ˆã‚Šã‚‚é«˜é€Ÿã«è¨ˆç®—ã§ããã†ã§ã™ã€‚ã“ã®æ–¹æ³•ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€æº€ç‚¹è§£ç­”ã‚’å¾—ã‚‰ã‚Œã¾ã™ã€‚

èµ¤ + ç·‘ ã®çµ„ã¿åˆã‚ã›ã®è¨ˆç®—ã¯ä¸€è¦‹è¤‡é›‘ã§ã™ãŒã€ç•³ã¿è¾¼ã¿æ¼”ç®—ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ä¸€æ‹¬ã§æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚AtCoder Library ã® convolution ã‚’ãã®ã¾ã¾åˆ©ç”¨ã§ãã¾ã™ã€‚

* [atcoder\.github\.io/ac\-library/production/document\_ja/convolution\.html](https://atcoder.github.io/ac-library/production/document_ja/convolution.html)
* [convolution in ac\_library::convolution \- Rust](https://docs.rs/ac-library-rs/latest/ac_library/convolution/fn.convolution.html)

|ğŸ”´|$a_0$|$a_1$|$a_2$|$a_3$|$a_4$|$a_5$|
|---|---|---|---|---|---|---|
|å€¤|$0$|$0$|${}_5C_2$|${}_5C_3$|${}_5C_4$|${}_5C_5$|

|ğŸŸ¢|$b_0$|$b_1$|$b_2$|$b_3$|$b_4$|$b_5$|
|---|---|---|---|---|---|---|
|å€¤|$0$|${}_5C_1$|${}_5C_2$|${}_5C_3$|${}_5C_4$|${}_5C_5$|

2ã¤ã®é…åˆ—ã‚’ç•³ã¿è¾¼ã¿æ¼”ç®—ã—ãŸçµæœã€æ¬¡ã®ã‚ˆã†ãªçµæœãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚

|ç•³ã¿è¾¼ã¿|å¼||||||çµæœ|
|---|---|---|---|---|---|---|---|
|0ï¸âƒ£$c_0$|$=a_0 b_0$||||||$=0$|
|     |$0 \cdot 0$|||||||
|1ï¸âƒ£$c_1$|$=a_0 b_1$|$+a_1 b_0$|||||$=0$|
|     |$0 \cdot {}_5C_1$|$0 \cdot 0$|
|2ï¸âƒ£$c_2$|$=a_0 b_2$|$+a_1 b_1$|$+a_2 b_0$||||$=0$|
|     |$0 \cdot {}_5C_2$|$0 \cdot {}_5C_1$|${}_5C_2\cdot 0$|
|3ï¸âƒ£$c_3$|$=a_0 b_3$|$+a_1 b_2$|+$a_2 b_1$|+$a_3 b_0$|||$=50$|
|     |$0 \cdot {}_5C_3$|$0 \cdot {}_5C_2$|${}_5C_2\cdot {}_5C_1$|${}_5C_3\cdot 0$|
|4ï¸âƒ£$c_4$|$a_0 b_4$|$a_1 b_3$|$a_2 b_2$|$a_3 b_1$|$a_4 b_0$||$=150$
|     |$0 \cdot {}_5C_4$|$0 \cdot {}_5C_3$|${}_5C_2\cdot {}_5C_2$|${}_5C_3\cdot {}_5C_1$|${}_5C_4\cdot 0$|
|5ï¸âƒ£$c_5$|$a_0 b_5$|$a_1 b_4$|$a_2 b_3$|$a_3 b_2$|$a_4 b_1$|$a_5 b_0$|$=225$
|     |$0 \cdot {}_5C_5$|$0 \cdot {}_5C_4$|${}_5C_2\cdot {}_5C_3$|${}_5C_3\cdot {}_5C_2$|${}_5C_4\cdot {}_5C_1$|${}_5C_5\cdot 0$|
|6ï¸âƒ£$c_6$|$a_1 b_5$|$a_2 b_4$|$a_3 b_3$|$a_4 b_2$|$a_5 b_1$||$=205$|
|     |$0 \cdot {}_5C_5$|${}_5C_2\cdot {}_5C_4$|${}_5C_3\cdot {}_5C_3$|${}_5C_4\cdot {}_5C_2$|${}_5C_5\cdot {}_5C_1$|
|7ï¸âƒ£$c_7$|$a_2 b_5$|$a_3 b_4$|$a_4 b_3$|$a_5 b_2$|||$=120$|
|     |${}_5C_2\cdot {}_5C_5$|${}_5C_3\cdot {}_5C_4$|${}_5C_4\cdot {}_5C_3$|${}_5C_5\cdot {}_5C_2$|
|8ï¸âƒ£$c_8$|$a_3 b_5$|$a_4 b_4$|$a_5 b_3$||||$=45$|
|     |${}_5C_3\cdot {}_5C_5$|${}_5C_4\cdot {}_5C_4$|${}_5C_5\cdot {}_5C_3$|
|9ï¸âƒ£$c_9$|$a_4 b_5$|$a_5 b_4$|||||$=10$|
|     |${}_5C_4\cdot {}_5C_5$|${}_5C_5\cdot {}_5C_4$|
|ğŸ”Ÿ$c_{10}$|$a_5 b_5$||||||$=1$|
|     |${}_5C_5\cdot {}_5C_5$|

ç•³ã¿è¾¼ã¿ã‚’è¡Œã„ã€ãã®å¾Œã€é’ã®ãƒœãƒ¼ãƒ«ã¨ã®çµ„ã¿åˆã‚ã›ã‚’è¨ˆç®—ã™ã‚‹éƒ¨åˆ†ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãª Rust ã‚³ãƒ¼ãƒ‰ã§å®Ÿè£…ã§ãã¾ã™ã€‚

```rust
let rgs = convolution(&rs, &gs);

let mut result = Mint::new(0);
for ib in 0..=(b1 - b0) {
    let i = k - (r0 + g0 + b0 + ib);
    result += rgs[i] * bs[ib];
}
```

ãŠç–²ã‚Œã•ã¾ã§ã—ãŸã€‚

## çµ„ã¿åˆã‚ã›ã¨ä½™ã‚Š

çµ„ã¿åˆã‚ã›ã®æ•°ã¯ã€æ¬¡ã®å¼ã§æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚

$${}_nC_r = \frac{n!}{r!(n-r)!}$$

ã“ã®å•é¡Œã§ã¯çµ„ã¿åˆã‚ã›ã®æ•°ãŒéå¸¸ã«å¤§ãããªã‚‹ãŸã‚ã€998244353 ã§å‰²ã£ãŸä½™ã‚Šã‚’è§£ç­”ã¨ã—ã¦æ±‚ã‚ã¾ã™ã€‚

æ¯å›éšä¹—ã‚’è¨ˆç®—ã™ã‚‹ã¨å‡¦ç†ãŒé…ããªã‚‹ãŸã‚ã€äº‹å‰ã«éšä¹—ã¨ãã®é€†æ•°ã‚’è¨ˆç®—ã—ã€é…åˆ—ã«ä¿å­˜ã—ã¦ãŠãã®ãŒåŠ¹ç‡çš„ã§ã™ã€‚ã“ã†ã™ã‚‹ã“ã¨ã§ã€çµ„ã¿åˆã‚ã›ã®è¨ˆç®—ã¯ã€äº‹å‰ã«è¨ˆç®—ã—ãŸ $n!$, $1/r!$, $1/(n-r)!$ ã®3ã¤ã®å€¤ã‚’ã‹ã‘åˆã‚ã›ã‚‹ã ã‘ã§ã€é«˜é€Ÿã«è¡Œãˆã¾ã™ã€‚

||0|1|2|3|4|5|...|
|---|---|---|---|---|---|---|---|
|$n!$|1|1|2|6|24|120|
|$1/n!$|1|1|499122177|166374059|291154603|856826403|

```rust

fn build_fact(n: usize) -> Vec<Mint> {
    let mut fact = vec![Mint::new(1); n + 1];
    for i in 2..=n {
        fact[i] = fact[i - 1] * i;
    }
    fact
}

fn build_fact_inv(fact: &[Mint]) -> Vec<Mint> {
    let n = fact.len() - 1;
    let mut fact_inv = vec![Mint::new(1); n + 1];
    for i in 0..=n {
        fact_inv[i] = fact[i].inv();
    }
    fact_inv
}
```


# å®Ÿè£…ä¾‹

## ç•³ã¿è¾¼ã¿ãªã— (TLE)
https://github.com/hossy3/atcoder-solutions/blob/main/atcoder/typical90/src/bin/065_combination_2_tle.rs

## ç•³ã¿è¾¼ã¿ã‚ã‚Š
https://github.com/hossy3/atcoder-solutions/blob/main/atcoder/typical90/src/bin/065_convolution.rs
