---
title: "053 - Discrete Dowsingï¼ˆâ˜…7ï¼‰"
---

[053 \- Discrete Dowsingï¼ˆâ˜…7ï¼‰](https://atcoder.jp/contests/typical90/tasks/typical90_ba)


# ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 
## å•é¡Œ
```mermaid
xychart-beta
  x-axis [1, 2, 3, 4, 5, 6, 7, 8]
  y-axis 0 --> 9
  bar [1, 2, 3, 4, 5, 6, 9, 1]
```

`(1,2,3,4,5,6,9,1)` ã®ã‚ˆã†ã«ã€é€”ä¸­ã¾ã§æ˜‡é †ã€ãã“ã‹ã‚‰å…ˆã¯é™é †ã«ä¸¦ã¶æ•°åˆ—ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã®ä¸­ã§ã«ã‚ã‚‹ã‚‚ã£ã¨ã‚‚å¤§ããªå€¤ `9` ã‚’ã€ã§ãã‚‹ã ã‘å°‘ãªã„å•ã„åˆã‚ã›å›æ•°ã§æ¢ã™ã€ã¨ã„ã†ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å•é¡Œã§ã™ã€‚


## ã‚¯ã‚¨ãƒªãƒ¼å›æ•°ã«å¯¾ã™ã‚‹ã€æ‰±ãˆã‚‹æœ€é•·ã®æ•°åˆ—ã‚’è€ƒãˆã‚‹

æ•°åˆ—ã‹ã‚‰ã‚¯ã‚¨ãƒªãƒ¼ (å•ã„åˆã‚ã›æ–¹æ³•) ã‚’è€ƒãˆã‚‹ã®ã¯é›£ã—ã„ã§ã™ã€‚é€†ã«ã€ã©ã†ã™ã‚Œã°ã‚‚ã£ã¨ã‚‚åŠ¹ç‡çš„ãªã‚¯ã‚¨ãƒªãƒ¼ã«ãªã‚‹ã‹ã‚’ã€ä¾‹ã‚’ã‚‚ã¨ã«è€ƒãˆã¾ã™ã€‚


### ã‚¯ã‚¨ãƒªãƒ¼ 1å›: 1è¦ç´ ã®æ•°åˆ—

||$A_1$|
|---|---|
|å•ã„åˆã‚ã›|ğŸ”|
|å€¤ã®ä¾‹|1ğŸ‘|

1å›å•ã„åˆã‚ã›ã‚Œã°ã€ 1è¦ç´ ã®æ•°åˆ—å†…ã®æœ€å¤§å€¤ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚

### ã‚¯ã‚¨ãƒªãƒ¼ 2å›: 2è¦ç´ ã®æ•°åˆ—

||$A_1$|$A_2$|
|---|---|---|
|å•ã„åˆã‚ã›|ğŸ”|ğŸ”|
|å€¤ã®ä¾‹|1|2ğŸ‘|

2å›å•ã„åˆã‚ã›ã‚Œã°ã€ 2è¦ç´ ã®æ•°åˆ—å†…ã®æœ€å¤§å€¤ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚

### ã‚¯ã‚¨ãƒªãƒ¼ 3å›: 4è¦ç´ ã®æ•°åˆ—

||$A_1$|$A_2$|$A_3$|$A_4$|
|---|---|---|---|---|
|å•ã„åˆã‚ã›|â”|ğŸ”|ğŸ”|â”|
|å€¤ã®ä¾‹|1|4ğŸ‘|3ğŸ‘|2|
|æ¬¡ã®å€™è£œ|ğŸ”|ğŸ”|âŒ|âŒ|

||$A_1$|$A_2$|$A_3$|$A_4$|
|---|---|---|---|---|
|å•ã„åˆã‚ã›|â”|ğŸ”|ğŸ”|â”|
|å€¤ã®ä¾‹|1|2ğŸ‘|3ğŸ‘|4|
|æ¬¡ã®å€™è£œ|âŒ|âŒ|ğŸ”|ğŸ”|

1å›ã®å•ã„åˆã‚ã›ã§ã€1ã¤å‰ã®ã€Œ2è¦ç´ ã®é…åˆ—ã€ã¾ã§çµã‚Šè¾¼ã‚ã‚‹é…åˆ—ã‚’è€ƒãˆã¾ã™ã€‚

è¿½åŠ ã§ã€Œ2è¦ç´ ã®é…åˆ—ã€ã®éš£ã® $A_3$ ã‚’èª¿ã¹ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚ã‚¯ã‚¨ãƒªãƒ¼2å›ã®å ´åˆã¨é‡ãªã‚Šã¾ã›ã‚“ã®ã§ã€æƒ…å ±ã®ç„¡é§„ãŒãªã„ã¯ãšã§ã™ã€‚

ã€Œâ”ğŸ”ğŸ”ã€ã«ãªã‚Šã¾ã—ãŸã€‚

æ¬¡ã«ã€å·¦å³å¯¾ç§°ã«ã—ã¾ã™ã€‚ $A_4$ ã‚’è¿½åŠ ã—ã¾ã™ã€‚å·¦ã®ğŸ”ã‚’é¸ã‚“ã§ã‚‚å³ã®ğŸ”ã‚’é¸ã‚“ã§ã‚‚åŠ¹ç‡ãŒå¤‰ã‚ã‚‰ãªã„ã‚ˆã†ã«ã€ã§ã™ã€‚â”ã‚’å³ã« 1ã¤å¢—ã‚„ã—ã¾ã™ã€‚

 ã€Œâ”ğŸ”ğŸ”â”ã€ã«ãªã‚Šã¾ã—ãŸã€‚4è¦ç´ ã®é…åˆ—ã§ã™ã€‚

$A_2$ ã¨ $A_3$ ã‚’æ¯”ã¹ã€$A_2$ ãŒå¤§ãã‘ã‚Œã°å·¦å´ã‚’ã€$A_3$ ãŒå¤§ãã‘ã‚Œã°å³å´ã‚’èª¿ã¹ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã©ã¡ã‚‰ã‚‚ 2è¦ç´ ã§ã€ã‹ã¤æ¬¡ã«èª¿ã¹ãŸã„ ğŸ” ã®ä¸€æ–¹ã‚’èª¿ã¹çµ‚ãˆã¦ã„ã‚‹çŠ¶æ…‹ã§ã™ã€‚ç„¡é§„ãªãæ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«é€²ã‚ã‚‰ã‚Œã¾ã™ã€‚


### ã‚¯ã‚¨ãƒªãƒ¼ 4å›: 7è¦ç´ ã®æ•°åˆ—

||$A_1$|$A_2$|$A_3$|$A_4$|$A_5$|$A_6$|$A_7$|
|---|---|---|---|---|---|---|---|
|å•ã„åˆã‚ã›|â”|â”|ğŸ”|â”|ğŸ”|â”|â”|
|å€¤ã®ä¾‹|2|4|6ğŸ‘|7|5ğŸ‘|3|1|
|æ¬¡ã®å€™è£œ|â”|ğŸ”|ğŸ”|â”|âŒ|âŒ|âŒ|

||$A_1$|$A_2$|$A_3$|$A_4$|$A_5$|$A_6$|$A_7$|
|---|---|---|---|---|---|---|---|
|å•ã„åˆã‚ã›|â”|â”|ğŸ”|â”|ğŸ”|â”|â”|
|å€¤ã®ä¾‹|2|3|4ğŸ‘|5|6ğŸ‘|7|1|
|æ¬¡ã®å€™è£œ|âŒ|âŒ|âŒ|â”|ğŸ”|ğŸ”|â”|

åŒã˜ã‚ˆã†ã«ã€1å›ã®å•ã„åˆã‚ã›ã§ã€1ã¤å‰ã®ã€Œ4è¦ç´ ã®é…åˆ—ã€ã¾ã§çµã‚Šè¾¼ã‚ã‚‹é…åˆ—ã‚’è€ƒãˆã¾ã™ã€‚

è¿½åŠ ã§ã€Œ4è¦ç´ ã®é…åˆ—ã€ã®éš£ã® $A_5$ ã‚’èª¿ã¹ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚ã‚¯ã‚¨ãƒªãƒ¼2å›ã®å ´åˆã¨é‡ãªã‚Šã¾ã›ã‚“ã®ã§ã€æƒ…å ±ã®ç„¡é§„ãŒãªã„ã¯ãšã§ã™ã€‚

ã€Œâ”â”ğŸ”â”ğŸ”ã€ã«ãªã‚Šã¾ã—ãŸã€‚

æ¬¡ã«ã€å·¦å³å¯¾ç§°ã«ã—ã¾ã™ã€‚ $A_6, A_7$ ã‚’è¿½åŠ ã—ã¾ã™ã€‚â”ã‚’å³ã« 2ã¤å¢—ã‚„ã—ã¾ã™ã€‚

ã€Œâ”â”ğŸ”â”ğŸ”â”â”ã€ã«ãªã‚Šã¾ã—ãŸã€‚7è¦ç´ ã®é…åˆ—ã§ã™ã€‚

$A_3$ ã¨ $A_5$ ã‚’æ¯”ã¹ã€$A_3$ ãŒå¤§ãã‘ã‚Œã°å·¦å´ã‚’ã€$A_5$ ãŒå¤§ãã‘ã‚Œã°å³å´ã‚’èª¿ã¹ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã©ã¡ã‚‰ã‚‚ 2è¦ç´ ã§ã™ã€‚ç„¡é§„ãªãæ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã«é€²ã‚ã‚‰ã‚Œã¾ã™ã€‚

### ã‚¯ã‚¨ãƒªãƒ¼ nå›

|ã‚¯ã‚¨ãƒªãƒ¼æ•°|æ•°åˆ—ã¨èª¿ã¹æ–¹|ğŸ”å·¦ä½ç½®|ğŸ”å³ä½ç½®|æ•°åˆ—ã®é•·ã•|
|---|---|---|---|---|
|1|ğŸ”|-|1|1|
|2|ğŸ”ğŸ”|1|2|2|
|3|â”ğŸ”ğŸ”â”|2|3|4|
|4|â”â”ğŸ”â”ğŸ”â”â”|3|5|7|
|5|â”â”â”â”ğŸ”â”â”ğŸ”â”â”â”â”|5|8|12|
|6|(ç•¥)|8|13|20|
|7|(ç•¥)|13|21|33|
|8|(ç•¥)|21|34|54|
|9|(ç•¥)|34|55|88|
|10|(ç•¥)|55|89|143|
|11|(ç•¥)|89|144|232|
|12|(ç•¥)|144|233|376|
|13|(ç•¥)|233|377|609|
|14|(ç•¥)|377|610|986|
|15|(ç•¥)|610|987|1596|

ã“ã‚Œã¯ãƒ•ã‚£ãƒœãƒŠãƒƒãƒæ•°åˆ—ã®è¨ˆç®—ã¨åŒã˜ã§ã™ã€‚

æ•°åˆ—ã®é•·ã•ãŒ 1500 ã¾ã§ãªã‚‰ã€æœ€å¤§ 15å›å•ã„åˆã‚ã›ã‚‹ã“ã¨ã§æœ€å¤§å€¤ãŒæ±‚ã¾ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚

æ•°å¼ã§ã‚‚è€ƒãˆã¾ã™ã€‚

å·¦å³å¯¾ç§°ã«ãªã‚‹ã‚ˆã†ã« ğŸ” ã‚’ç½®ã“ã†ã¨ã™ã‚‹ã¨ã€å‰å›ã®å·¦ã® ğŸ” ã¾ã§ã®å½¢ã‚’å³å´ã«è¿½åŠ ã—ã¾ã™ã€‚ $R_{i+1}=L_{i+1}+L_i$ ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

æ•°åˆ—ã®é•·ã•ã¯ã€æ¬¡ã®å³ã® ğŸ” ä½ç½®ã‚ˆã‚Š 1 å°ã•ããªã‚Šã¾ã™ã€‚$W_i=R_{i+1}-1$ ã§ã™ã€‚

|ã‚¯ã‚¨ãƒªãƒ¼æ•°|æ•°åˆ—ã¨èª¿ã¹æ–¹|ğŸ”å·¦ä½ç½® $L_i$|ğŸ”å³ä½ç½® $R_i$|æ•°åˆ—ã®é•·ã• $W_i$|
|---|---|---|---|---|
|1|ğŸ”|-|$R_1=1$|$W_1=R_2-1=1$|
|2|ğŸ”ğŸ”|$L_2=R_1=1$|$R_2=2$|$W_2=R_3-1=2$|
|3|â”ğŸ”ğŸ”â”|$L_3=R_2=2$|$R_3=L_3+L_2=3$|$W_3=R_4-1=4$|
|4|â”â”ğŸ”â”ğŸ”â”â”|$L_4=R_3=3$|$R_4=L_4+L_3=5$|$W_4=R_5-1=7$|
|5|â”â”â”â”ğŸ”â”â”ğŸ”â”â”â”â”|$L_5=R_4=5$|$R_5=L_5+L_4=8$|$W_5=R_6-1=12$|

* $L_{i+1} = R_{i}$
* $R_{i+1} = L_{i+1} + L_i$

L å´ã«ã¾ã¨ã‚ã‚‹ã¨

* $L_{i+2} = L_{i+1} + L_i$

ç¢ºã‹ã«ãƒ•ã‚£ãƒœãƒŠãƒƒãƒæ•°åˆ—ã®å¼ã§ã—ãŸã€‚


## æœ€é•·ã§ãªã„æ•°åˆ—ã®å ´åˆ

ã‚¯ã‚¨ãƒªãƒ¼å›æ•°ã«å¯¾ã—ã¦æœ€é•·ã®é…åˆ—ã¯åˆ†ã‹ã‚Šã¾ã—ãŸã€‚ã§ã¯ã€æœ€é•·ã§ãªã„ã‚‚ã®ã‚‚åŒã˜ã‚ˆã†ã«æ‰±ãˆã‚‹ã§ã—ã‚‡ã†ã‹ã€‚ç¢ºèªã—ã¾ã™ã€‚

(1, 2, 3, 4, 5, 6, 7, 8, 9) ã¨ã„ã†é…åˆ—ãŒéš ã‚Œã¦ã„ã‚‹å ´åˆã«ã¤ã„ã¦èª¿ã¹ã¾ã™ã€‚

||$A_1$|$A_2$|$A_3$|$A_4$|$A_5$|$A_6$|$A_7$|$A_8$|$A_9$||
|---|---|---|---|---|---|---|---|---|---|---|
|å€¤|1|2|3|4|5|6|7|8|9|
|å•ã„åˆã‚ã›|â”|â”|â”|â”|ğŸ”|â”|â”|ğŸ”|â”|
|æ¯”è¼ƒ|||||ğŸ‘|||ğŸ‘||
|æ¬¡ã®å€™è£œ|âŒ|âŒ|âŒ|âŒ|âŒ|â”|â”|ğŸ”|â”|ğŸ”â”â”

å³ã®å€™è£œã® ğŸ” ãŒã¯ã¿å‡ºã—ã¦ã„ã¾ã™ã€‚ã“ã®å ´åˆã¯èª¿ã¹ã‚‹ã®ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ã€æ¬¡ã®å€™è£œã«é€²ã‚ã°è‰¯ã„ã§ã™ã€‚ `-1` ãªã©å¿…ãšè² ã‘ã‚‹å€¤ã‚’è¿”ã™å½¢ã§ã‚‚è‰¯ã„ã§ã™ã€‚

||$A_1$|$A_2$|$A_3$|$A_4$|$A_5$|$A_6$|$A_7$|$A_8$|$A_9$||
|---|---|---|---|---|---|---|---|---|---|---|
|å€¤|1|2|3|4|5|6|7|8|9|
|å•ã„åˆã‚ã›|â”|â”|â”|â”|ğŸ”|â”|â”|ğŸ”|â”|
|æ¯”è¼ƒ|||||ğŸ‘|||ğŸ‘||
|æ¬¡ã®å€™è£œ|âŒ|âŒ|âŒ|âŒ|âŒ|â”|â”|ğŸ”|â”|ğŸ”â”â”
|æ¯”è¼ƒ||||||||ğŸ‘||ğŸ‘
|æ¬¡ã®å€™è£œ||||||â”|ğŸ”|ğŸ”|â”|âŒâŒâŒ
|æ¯”è¼ƒ|||||||ğŸ‘|ğŸ‘||
|æ¬¡ã®å€™è£œ||||||âŒ|âŒ|ğŸ”|ğŸ”|
|æ¯”è¼ƒ||||||||ğŸ‘|ğŸ‘|
|æ¬¡ã®å€™è£œ||||||||âŒ|ğŸ”|

||$A_1$|$A_2$|$A_3$|$A_4$|$A_5$|$A_6$|$A_7$|$A_8$|$A_9$||
|---|---|---|---|---|---|---|---|---|---|---|
|å•ã„åˆã‚ã›||||||â”|ğŸ”|ğŸ”|â”|
|å€¤ã®ä¾‹|1|2|3|4|5|6|7ğŸ‘|8ğŸ‘|9|
|æ¬¡ã®å€™è£œ||||||âŒ|âŒ|ğŸ”|ğŸ”|

æœ€é•·ã§ãªã„æ•°åˆ—ã«ã¤ã„ã¦ã‚‚ã€æœ€å¤§å€¤ã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚


## ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å•é¡Œã®å…¥å‡ºåŠ›

* [proconio \- Rust > Interactive version](https://docs.rs/proconio/0.5.0/proconio/#interactive-version)

```diff rust
-input! {
+input_interactive! {
     t: usize,
 }
```

AtCoder ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å•é¡Œã§ã¯ã€å€¤ã®å…¥åŠ›ã®éš›ã« `input_interactive!` ã‚’ä½¿ã†ã¨ä¾¿åˆ©ã§ã™ã€‚

ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å•é¡Œä»¥å¤–ã§ã¯ã€`input!` ã‚’ä½¿ã„ã¾ã™ã€‚ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’å„ªå…ˆã—ã€å…¥åŠ›å€¤ã‚’ã¾ã¨ã‚ã¦èª­ã¿è¾¼ã¿ã¾ã™ã€‚å…¥åŠ›ã¨å‡ºåŠ›ã‚’äº¤äº’ã«ç¹°ã‚Šè¿”ã™å ´åˆã«ã¯ã†ã¾ãå‹•ã‹ãšã€TLE ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚

AtCoder 2023å¹´è¨€èªã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆä»¥å‰ã¯ `input_interactive!` ãŒä½¿ãˆã¾ã›ã‚“ã§ã—ãŸã€‚æ¥½ã«ãªã‚Šã¾ã—ãŸã€‚


## ãƒ¡ãƒ¢åŒ–

4ã¤ã®å€¤ã®æœ€å¤§å€¤ã‚’èª¿ã¹ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’è€ƒãˆã¾ã™ã€‚

||$A_1$|$A_2$|$A_3$|$A_4$|
|---|---|---|---|---|
|å€¤|1|2|3|4|
|å•ã„åˆã‚ã›1|â”|ğŸ”|ğŸ”|â”|
|æ¯”è¼ƒ||ğŸ‘|ğŸ‘|
|å•ã„åˆã‚ã›2|âŒ|âŒ|ğŸ”|ğŸ”|
|æ¯”è¼ƒ|||ğŸ‘|ğŸ‘

å•ã„åˆã‚ã›ã”ã¨ã« ğŸ” ã‚’ 2ã¤èª¿ã¹ã‚‹ãªã‚‰ã€æ¬¡ã®ã‚ˆã†ã«çµã‚Šè¾¼ã¿ã‚’è¡Œãˆã¾ã™ã€‚

```rust
let query = |i: usize| -> usize {
    println!("? {}", i);
    input_interactive! {
        x: usize,
    }
    x
};

let mut l = 0;
for v in fibo.windows(2).rev() {
    let l0 = l + v[0];
    let r0 = l + v[1];
    if r0 > n {
        continue;
    }
    if query(r0) > query(l0) {
        l = l0;
    }
}
query(l + 1)
```

åŒã˜å ´æ‰€ã«å¯¾ã—ã¦ 2å›å•ã„åˆã‚ã›ã¦ã„ã¾ã™ã€‚æœ€å¤§ 15å›ã®å•ã„åˆã‚ã›ã§æ¸ˆã‚€ã¯ãšã®ã¨ã“ã‚ãŒã€å€è¿‘ãå•ã„åˆã‚ã›ã‚‹ã“ã¨ã«ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚

`query()` é–¢æ•°ãŒã€åŒã˜å¼•æ•°ã‚’æ¸¡ã•ã‚ŒãŸã¨ãã« `input_interactive!` ã›ãšã«å‰å›ã¨åŒã˜å€¤ã‚’è¿”ã™ã‚ˆã†ã«ã™ã‚‹ã¨ã€è§£æ¶ˆã—ã¾ã™ã€‚ã€Œãƒ¡ãƒ¢åŒ–ã€ã¨ã„ã†ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã§ã™ã€‚

```diff rust
-let query = |i: usize| -> usize {
+let mut map = BTreeMap::new();
+let mut query_memo = |i: usize| -> usize {
+    if let Some(&x) = map.get(&i) {
+        return x;
+    }
     println!("? {}", i);
     input_interactive! {
         x: usize,
     }
+    map.insert(i, x);
     x
 };
 let mut l = 0;
 for v in fibo.windows(2).rev() {
     let l0 = l + v[0];
     let r0 = l + v[1];
     if r0 > n {
         continue;
     }
-    if query(r0) > query(l0) {
+    if query_memo(r0) > query_memo(l0) {
         l = l0;
     }
 }
-query_memo(l + 1)
+query(l + 1)
```

ã“ã‚Œã§æº€ç‚¹è§£ç­”ã¨ãªã‚Šã¾ã™ã€‚ãŠç–²ã‚Œã•ã¾ã§ã—ãŸã€‚

### ãƒ¡ãƒ¢åŒ–ç¯„å›²ã‚’ç‹­ã‚ã‚‹

ä½¿ã„ã¾ã‚ã™å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã¯ã€å‰å›èª¿ã¹ãŸ ğŸ” ã®ã†ã¡ç‰‡æ–¹ã§ã™ã€‚éå»ã™ã¹ã¦ã®å€¤ã‚’ãƒ¡ãƒ¢åŒ–ã—ãªãã¦ã‚‚è‰¯ã„ã§ã™ã€‚

å‰å›ã®å€¤ã ã‘è¦šãˆã‚‹ãªã‚‰ã€ã“ã®ã‚ˆã†ã«ã‚‚æ›¸ã‘ã¾ã™ã€‚

```rust
let query = |i: usize| -> usize {
    if i <= n {
        println!("? {}", i);
        input_interactive! {
            x: usize,
        }
        x
    } else {
        0
    }
};

if n == 1 {
    return query(1);
}

let mut l = 0;
let mut rx = query(fibo[fibo.len() - 1]);
let mut lx = query(fibo[fibo.len() - 2]);
for v in fibo[..(fibo.len() - 1)].windows(2).rev() {
    if rx > lx {
        l += v[1];
        lx = rx;
        rx = query(l + v[1]);
    } else {
        rx = lx;
        lx = query(l + v[0]);
    }
}

lx.max(rx)
```

ã“ã‚Œã‚‚æº€ç‚¹è§£ç­”ã§ã™ã€‚ã—ã‹ã—å¯å¤‰ãªçŠ¶æ…‹ãŒå¢—ãˆã¦é›£ã—ããªã‚Šã¾ã™ã€‚ç§ã¯ã™ã¹ã¦è¦šãˆã‚‹æ–¹ãŒå¥½ã¿ã§ã™ã€‚


# Tips

## ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å•é¡Œã®å˜ä½“ãƒ†ã‚¹ãƒˆ

ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å•é¡Œã¯å˜ä½“ãƒ†ã‚¹ãƒˆãŒã¨ã¦ã‚‚é›£ã—ã„ã§ã™ã€‚é–¢æ•°ã®å¼•æ•°ã¨è¿”å€¤ã§å‹•ä½œç¢ºèªã‚’ã—ãŸãã¦ã‚‚ã€æ¨™æº–å…¥å‡ºåŠ›ãŒé‚ªé­”ã‚’ã—ã¾ã™ã€‚

ç§ã¯ä¼¼ãŸé–¢æ•°ã‚’ã‚³ãƒ”ãƒšã§ä½œã£ã¦ãã‚Œã£ã½ãç¢ºèªã—ã¾ã—ãŸã€‚


```rust
// ãƒ†ã‚¹ãƒˆã—ãŸã„é–¢æ•°
fn solve() -> usize {
    input_interactive! {
        n: usize,
    }
    let fibo = build_fibo(n);

    let mut map = BTreeMap::new();
    let mut query_memo = |i: usize| -> usize {
        if let Some(&x) = map.get(&i) {
            return x;
        }

        println!("? {}", i);
        input_interactive! {
            x: usize,
        }
        map.insert(i, x);
        x
    };

    let mut l = 0;
    for v in fibo.windows(2).rev() {
        let l0 = l + v[0];
        let r0 = l + v[1];
        if r0 > n {
            continue;
        }
        if query_memo(r0) > query_memo(l0) {
            l = l0;
        }
    }
    query_memo(l + 1)
}
```

```diff rust
 // ãƒ†ã‚¹ãƒˆç”¨ã®é–¢æ•°
-fn solve() -> usize {
+fn solve_like(a: &[usize]) -> (usize, Vec<usize>) {
-    input_interactive! {
-        n: usize,
-    }
+    let n = a.len();
     let fibo = build_fibo(n);

+    let mut queries = vec![];
     let mut map = BTreeMap::new();
     let mut query_memo = |i: usize| -> usize {
         if let Some(&x) = map.get(&i) {
             return x;
         }
-        println!("? {}", i);
-        input_interactive! {
-            x: usize,
-        }
+        queries.push(i);
+        let x = a[i - 1];
         map.insert(i, x);
         x
     };

     let mut l = 0;
     for v in fibo.windows(2).rev() {
         let l0 = l + v[0];
         let r0 = l + v[1];
         if r0 > n {
             continue;
         }
         if query_memo(r0) > query_memo(l0) {
             l = l0;
         }
     }
-    query_memo(l + 1)
+    (query_memo(l + 1), queries)
 }
```

```rust
#[test]
fn test_solve_like() {
    assert_eq!(solve_like(&[1]), (1, vec![1]));
    assert_eq!(solve_like(&[1, 2]), (2, vec![2, 1]));
    assert_eq!(solve_like(&[3, 2]), (3, vec![2, 1]));
    assert_eq!(solve_like(&[1, 2, 3, 4]), (4, vec![3, 2, 4]));
    assert_eq!(solve_like(&[1, 4, 3, 2]), (4, vec![3, 2, 1]));
    assert_eq!(solve_like(&[1, 2, 3, 5, 4]), (5, vec![5, 3, 4]));
    assert_eq!(solve_like(&[1, 2, 3, 7, 6, 5, 4]), (7, vec![5, 3, 6, 4]));
}
```

æœ€å¾Œã®ãƒ†ã‚¹ãƒˆã¯æ¬¡ã®å‹•ãã«å¯¾å¿œã—ã¾ã™ã€‚ã“ã“ã¾ã§ç¢ºèªã§ãã‚Œã°ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å•é¡Œã®æå‡ºã‚‚å®‰å¿ƒã§ã™ã€‚

||$A_1$|$A_2$|$A_3$|$A_4$|$A_5$|$A_6$|$A_7$|
|---|---|---|---|---|---|---|---|
|å€¤|1|2|3|7|6|5|4|
|å•ã„åˆã‚ã›: $A_5$|â”|â”|â”|â”|ğŸ”|â”|â”|
|å•ã„åˆã‚ã›: $A_3$|â”|â”|ğŸ”|â”|(ğŸ”)|â”|â”|
|æ¯”è¼ƒ|||ğŸ‘||ğŸ‘|||
|å•ã„åˆã‚ã›: $A_6$|âŒ|âŒ|âŒ|â”|(ğŸ”)|ğŸ”|â”|
|æ¯”è¼ƒ|||||ğŸ‘|ğŸ‘|
|å•ã„åˆã‚ã›: $A_4$||||ğŸ”|(ğŸ”)|âŒ|âŒ
|æ¯”è¼ƒ||||ğŸ‘|ğŸ‘||
|æœ€å¤§å€¤: 7||||(ğŸ”)|âŒ|||


# å®Ÿè£…ä¾‹

## ãƒ•ã‚£ãƒœãƒŠãƒƒãƒæ•°åˆ— + å…¨ä½“ãƒ¡ãƒ¢åŒ–
https://github.com/hossy3/atcoder-solutions/blob/main/atcoder/typical90/src/bin/053_interactive_golden.rs

## ãƒ•ã‚£ãƒœãƒŠãƒƒãƒæ•°åˆ— + éƒ¨åˆ†ãƒ¡ãƒ¢åŒ–
https://github.com/hossy3/atcoder-solutions/blob/main/atcoder/typical90/src/bin/053_interactive_golden_2.rs

